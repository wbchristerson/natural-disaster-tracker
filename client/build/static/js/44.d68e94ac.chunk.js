(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[44],{692:function(e,i,t){"use strict";t.r(i);var a=t(20),s=t(161),n=t(162),o=t(165),r=t(164),l=t(1),c=t.n(l),d=t(621),h=t(623),u=t(628),m=function(e){Object(o.a)(t,e);var i=Object(r.a)(t);function t(e){var a;return Object(s.a)(this,t),(a=i.call(this,e)).state={informalName:"",officialName:"",disasterType:"",isOngoing:!1,latitude:"",longitude:"",isValidInformalName:!0,isValidOfficialName:!0,isValidDisasterType:!0,isValidLatitude:!0,isValidLongitude:!0,isModalOpen:!1,authorizationFailure:null,showToast:!1},a.backEndHost=Object(u.m)(),a.frontEndHost=Object(u.p)(),a.disasterId=parseInt(a.props.location.search.substring(4)),a.originalInformalName="",a.originalOfficialName="",a.originalDisasterType="",a.originalIsOngoing=!1,a.originalLatitude="",a.originalLongitude="",a}return Object(n.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("".concat(this.backEndHost,"/api/disasters/").concat(this.disasterId)).then((function(e){return e.json()})).then((function(i){e.setState({informalName:i.informal_name,officialName:i.official_name,disasterType:i.disaster_type.charAt(0).toUpperCase()+i.disaster_type.slice(1),isOngoing:i.is_ongoing,latitude:i.location[0].toString(),longitude:i.location[1].toString()}),e.originalInformalName=i.informal_name,e.originalOfficialName=i.official_name,e.originalDisasterType=i.disaster_type.charAt(0).toUpperCase()+i.disaster_type.slice(1),e.originalIsOngoing=i.is_ongoing,e.originalLatitude=i.location[0].toString(),e.originalLongitude=i.location[1].toString()})).catch((function(i){console.log("Error fetching disaster with id ",e.disasterId),console.log(i)}))}},{key:"onInformalNameChange",value:function(e){this.setState({informalName:e.target.value})}},{key:"onOfficialNameChange",value:function(e){this.setState({officialName:e.target.value})}},{key:"onDisasterTypeChange",value:function(e){this.setState({disasterType:e.target.value})}},{key:"onIsOngoingChange",value:function(e){this.setState({isOngoing:!this.state.isOngoing})}},{key:"onLatitudeChange",value:function(e){this.setState({latitude:e.target.value})}},{key:"onLongitudeChange",value:function(e){this.setState({longitude:e.target.value})}},{key:"onSubmit",value:function(){var e=this,i=!0,t=!0,a=!0,s=!0,n=!0,o=this.state,r=o.informalName,l=o.officialName,c=o.disasterType,d=o.isOngoing,h=o.latitude,m=o.longitude;if(""==r&&(i=!1),""==l&&(t=!1),"Please select"==c&&(a=!1),Object(u.v)(h)||(s=!1),Object(u.v)(m)||(n=!1),i&&t&&a&&s&&n){var g={id:this.disasterId};r.trim()!=this.originalInformalName&&(g.informal_name=r.trim()),l.trim()!=this.originalOfficialName&&(g.official_name=l.trim()),c.trim()!=this.originalDisasterType&&(g.disaster_type=c.charAt(0).toLowerCase()+c.slice(1)),d!=this.originalIsOngoing&&(g.is_ongoing=d),h!=this.originalLatitude&&(g.location_latitude=h),m!=this.originalLongitude&&(g.location_longitude=m),this.setState({showToast:!1}),fetch("".concat(this.backEndHost,"/api/disasters"),{method:"PATCH",body:JSON.stringify(g),contentType:"application/json",headers:{"Content-Type":"application/json",Authorization:"Bearer "+Object(u.n)(u.e)}}).then((function(e){return e.json()})).then((function(i){console.log(i),401!=i.error||"authorization issue - 401 Unauthorized: The server could not verify that you are authorized to access the URL requested. You either supplied the wrong credentials (e.g. a bad password), or your browser doesn't understand how to supply the credentials required."!=i.message||i.success?403!=i.error||"authorization incorrect permission - 403 Forbidden: You don't have the permission to access the requested resource. It is either read-protected or not readable by the server."!=i.message||i.success?(e.originalInformalName=i.informal_name,e.originalOfficialName=i.official_name,e.originalDisasterType=i.disaster_type.charAt(0).toUpperCase()+i.disaster_type.slice(1),e.originalIsOngoing=i.is_ongoing,e.originalLatitude=i.location[0].toString(),e.originalLongitude=i.location[1].toString(),i.error||e.setState({showToast:!0})):e.setState({isModalOpen:!0,authorizationFailure:403}):e.setState({isModalOpen:!0,authorizationFailure:401})})).catch((function(i){console.log("Error fetching disaster with id ",e.disasterId),console.log(i)}))}this.setState({isValidInformalName:i,isValidOfficialName:t,isValidDisasterType:a,isValidLatitude:s,isValidLongitude:n})}},{key:"resetDisasterForm",value:function(){this.setState({informalName:this.originalInformalName,officialName:this.originalOfficialName,disasterType:this.originalDisasterType,isOngoing:this.originalIsOngoing,latitude:this.originalLatitude,longitude:this.originalLongitude,isValidInformalName:!0,isValidOfficialName:!0,isValidDisasterType:!0,isValidLatitude:!0,isValidLongitude:!0})}},{key:"onModalClose",value:function(){this.setState({isModalOpen:!1,authorizationFailure:null})}},{key:"render",value:function(){var e=this,i=this.state,s=i.isValidInformalName,n=i.isValidOfficialName,o=i.isValidDisasterType,r=i.isValidLatitude,l=i.isValidLongitude,c=i.isModalOpen,m=i.authorizationFailure,g=i.informalName,j=i.showToast;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(d.xb,{children:Object(a.jsx)(d.v,{xs:"12",children:Object(a.jsxs)(d.k,{children:[Object(a.jsxs)(d.o,{children:[Object(a.jsx)("h4",{children:"Edit Disaster"}),Object(a.jsx)("div",{className:"top-information-text",children:Object(u.l)("edit disaster listings")})]}),Object(a.jsx)(d.l,{children:Object(a.jsxs)(d.K,{action:"",method:"post",encType:"multipart/form-data",className:"form-horizontal",children:[Object(a.jsxs)(d.L,{row:!0,children:[Object(a.jsx)(d.v,{md:"3",children:Object(a.jsx)(d.db,{htmlFor:"text-input",children:"Informal Name"})}),Object(a.jsxs)(d.v,{xs:"12",md:"9",children:[s&&Object(a.jsx)(d.T,{id:"text-input",name:"text-input",placeholder:"Text",value:this.state.informalName,onChange:this.onInformalNameChange.bind(this)}),!s&&Object(a.jsx)(d.T,{id:"text-input",invalid:!0,name:"text-input",placeholder:"Text",value:this.state.informalName,onChange:this.onInformalNameChange.bind(this)}),Object(a.jsx)(d.bb,{children:"Informal name is blank or format is not recognized"}),Object(a.jsx)(d.M,{children:"The colloquial name of the disaster"})]})]}),Object(a.jsxs)(d.L,{row:!0,children:[Object(a.jsx)(d.v,{md:"3",children:Object(a.jsx)(d.db,{htmlFor:"text-input",children:"Official Name"})}),Object(a.jsxs)(d.v,{xs:"12",md:"9",children:[n&&Object(a.jsx)(d.T,{id:"text-input",name:"text-input",placeholder:"Text",value:this.state.officialName,onChange:this.onOfficialNameChange.bind(this)}),!n&&Object(a.jsx)(d.T,{id:"text-input",invalid:!0,name:"text-input",placeholder:"Text",value:this.state.officialName,onChange:this.onOfficialNameChange.bind(this)}),Object(a.jsx)(d.bb,{children:"Official name is blank or format is not recognized"}),Object(a.jsx)(d.M,{children:"The identifying name of the disaster"})]})]}),Object(a.jsxs)(d.L,{row:!0,children:[Object(a.jsx)(d.v,{md:"3",children:Object(a.jsx)(d.db,{htmlFor:"select",children:"Disaster Type"})}),Object(a.jsxs)(d.v,{xs:"12",md:"9",children:[o&&Object(a.jsx)(d.yb,{custom:!0,name:"select",id:"select",value:this.state.disasterType,onChange:this.onDisasterTypeChange.bind(this),children:u.b.map((function(e){return Object(a.jsx)("option",{value:e,children:e},e)}))}),!o&&Object(a.jsx)(d.yb,{invalid:!0,custom:!0,name:"select",id:"select",value:this.state.disasterType,onChange:this.onDisasterTypeChange.bind(this),children:t.disasterTypes.map((function(e){return Object(a.jsx)("option",{value:e,children:e},e)}))}),Object(a.jsx)(d.bb,{children:"No disaster type is selected"})]})]}),Object(a.jsxs)(d.L,{row:!0,children:[Object(a.jsx)(d.v,{tag:"label",sm:"3",className:"col-form-label",children:"Disaster Ongoing"}),Object(a.jsx)(d.v,{sm:"1",children:Object(a.jsx)(d.Hb,{id:"add-disaster-ongoing-switch",className:"mr-1",color:"danger",shape:"pill",checked:this.state.isOngoing,onChange:this.onIsOngoingChange.bind(this)})}),Object(a.jsx)(d.v,{sm:"3",children:Object(a.jsx)(d.db,{htmlFor:"add-disaster-ongoing-switch",children:this.state.isOngoing?"Yes":"No"})})]}),Object(a.jsxs)(d.L,{row:!0,children:[Object(a.jsx)(d.v,{md:"3",children:Object(a.jsx)(d.db,{htmlFor:"email-input",children:"Latitude"})}),Object(a.jsxs)(d.v,{xs:"12",md:"9",children:[r&&Object(a.jsx)(d.T,{type:"email",id:"email-input",name:"email-input",placeholder:"Disaster Latitude",value:this.state.latitude,onChange:this.onLatitudeChange.bind(this)}),!r&&Object(a.jsx)(d.T,{invalid:!0,type:"email",id:"email-input",name:"email-input",placeholder:"Disaster Latitude",value:this.state.latitude,onChange:this.onLatitudeChange.bind(this)}),Object(a.jsx)(d.bb,{children:"Provided latitude is blank or format is not recognized"}),Object(a.jsx)(d.M,{className:"help-block",children:"The latitude of the disaster"})]})]}),Object(a.jsxs)(d.L,{row:!0,children:[Object(a.jsx)(d.v,{md:"3",children:Object(a.jsx)(d.db,{htmlFor:"email-input",children:"Longitude"})}),Object(a.jsxs)(d.v,{xs:"12",md:"9",children:[l&&Object(a.jsx)(d.T,{type:"email",id:"email-input",name:"email-input",placeholder:"Disaster Latitude",value:this.state.longitude,onChange:this.onLongitudeChange.bind(this)}),!l&&Object(a.jsx)(d.T,{invalid:!0,type:"email",id:"email-input",name:"email-input",placeholder:"Disaster Latitude",value:this.state.longitude,onChange:this.onLongitudeChange.bind(this)}),Object(a.jsx)(d.bb,{children:"Provided longitude is blank or format is not recognized"}),Object(a.jsx)(d.M,{className:"help-block",children:"The longitude of the disaster"})]})]})]})}),Object(a.jsxs)(d.m,{children:[Object(a.jsxs)(d.f,{type:"submit",size:"sm",color:"primary",onClick:this.onSubmit.bind(this),children:[Object(a.jsx)(h.a,{name:"cil-scrubber"})," Submit"]}),Object(a.jsxs)(d.f,{type:"reset",size:"sm",color:"danger",onClick:this.resetDisasterForm.bind(this),children:[Object(a.jsx)(h.a,{name:"cil-ban"})," Reset"]})]})]})})}),Object(a.jsxs)(d.hb,{show:c,onClose:this.onModalClose.bind(this),children:[Object(a.jsx)(d.kb,{closeButton:!0,children:Object(a.jsx)(d.lb,{children:"Failure To Edit Disaster Listing"})}),Object(a.jsx)(d.ib,{children:Object(u.j)("edit disaster listings",m)}),Object(a.jsx)(d.jb,{children:Object(a.jsx)(d.f,{color:"secondary",onClick:function(){return e.onModalClose()},children:"OK"})})]}),Object(a.jsx)(d.Pb,{position:"top-center",children:Object(a.jsxs)(d.Mb,{show:j,autohide:5e3,fade:!0,children:[Object(a.jsx)(d.Ob,{closeButton:!0,children:"Disaster Listing Updated"}),Object(a.jsx)(d.Nb,{children:"The disaster listing for ".concat(g," has been updated successfully!")})]},"toast")},"toaster-top-center")]})}}]),t}(c.a.Component);i.default=m}}]);
//# sourceMappingURL=44.d68e94ac.chunk.js.map