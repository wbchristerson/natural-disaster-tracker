(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[7],{649:function(e,i,t){"use strict";t.r(i);var a=t(38),n=t(159),s=t(160),o=t(162),r=t(161),l=t(1),c=t.n(l),d=t(622),h=t(621),u=t(623),j=function(e){Object(o.a)(t,e);var i=Object(r.a)(t);function t(e){var a;return Object(n.a)(this,t),(a=i.call(this,e)).state={informalName:"",officialName:"",disasterType:"",isOngoing:!1,latitude:"",longitude:"",isValidInformalName:!0,isValidOfficialName:!0,isValidDisasterType:!0,isValidLatitude:!0,isValidLongitude:!0,isModalOpen:!1,authorizationFailure:null,showToast:!1},a.backEndHost=Object(u.m)(),a.frontEndHost=Object(u.p)(),a.disasterId=parseInt(a.props.location.search.substring(4)),a.originalInformalName="",a.originalOfficialName="",a.originalDisasterType="",a.originalIsOngoing=!1,a.originalLatitude="",a.originalLongitude="",a}return Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("".concat(this.backEndHost,"/api/disasters/").concat(this.disasterId)).then((function(e){return e.json()})).then((function(i){e.setState({informalName:i.informal_name,officialName:i.official_name,disasterType:i.disaster_type.charAt(0).toUpperCase()+i.disaster_type.slice(1),isOngoing:i.is_ongoing,latitude:i.location[0].toString(),longitude:i.location[1].toString()}),e.originalInformalName=i.informal_name,e.originalOfficialName=i.official_name,e.originalDisasterType=i.disaster_type.charAt(0).toUpperCase()+i.disaster_type.slice(1),e.originalIsOngoing=i.is_ongoing,e.originalLatitude=i.location[0].toString(),e.originalLongitude=i.location[1].toString()})).catch((function(i){console.log("Error fetching disaster with id ",e.disasterId),console.log(i)}))}},{key:"onInformalNameChange",value:function(e){this.setState({informalName:e.target.value})}},{key:"onOfficialNameChange",value:function(e){this.setState({officialName:e.target.value})}},{key:"onDisasterTypeChange",value:function(e){this.setState({disasterType:e.target.value})}},{key:"onIsOngoingChange",value:function(e){this.setState({isOngoing:!this.state.isOngoing})}},{key:"onLatitudeChange",value:function(e){this.setState({latitude:e.target.value})}},{key:"onLongitudeChange",value:function(e){this.setState({longitude:e.target.value})}},{key:"onSubmit",value:function(){var e=this,i=!0,t=!0,a=!0,n=!0,s=!0,o=this.state,r=o.informalName,l=o.officialName,c=o.disasterType,d=o.isOngoing,h=o.latitude,j=o.longitude;if(""==r&&(i=!1),""==l&&(t=!1),"Please select"==c&&(a=!1),Object(u.v)(h)||(n=!1),Object(u.v)(j)||(s=!1),i&&t&&a&&n&&s){var g={id:this.disasterId};r.trim()!=this.originalInformalName&&(g.informal_name=r.trim()),l.trim()!=this.originalOfficialName&&(g.official_name=l.trim()),c.trim()!=this.originalDisasterType&&(g.disaster_type=c.charAt(0).toLowerCase()+c.slice(1)),d!=this.originalIsOngoing&&(g.is_ongoing=d),h!=this.originalLatitude&&(g.location_latitude=h),j!=this.originalLongitude&&(g.location_longitude=j),this.setState({showToast:!1}),fetch("".concat(this.backEndHost,"/api/disasters"),{method:"PATCH",body:JSON.stringify(g),contentType:"application/json",headers:{"Content-Type":"application/json",Authorization:"Bearer "+Object(u.n)(u.e)}}).then((function(e){return e.json()})).then((function(i){401!=i.error||"authorization issue - 401 Unauthorized: The server could not verify that you are authorized to access the URL requested. You either supplied the wrong credentials (e.g. a bad password), or your browser doesn't understand how to supply the credentials required."!=i.message||i.success?403!=i.error||"authorization incorrect permission - 403 Forbidden: You don't have the permission to access the requested resource. It is either read-protected or not readable by the server."!=i.message||i.success?(e.originalInformalName=i.informal_name,e.originalOfficialName=i.official_name,e.originalDisasterType=i.disaster_type.charAt(0).toUpperCase()+i.disaster_type.slice(1),e.originalIsOngoing=i.is_ongoing,e.originalLatitude=i.location[0].toString(),e.originalLongitude=i.location[1].toString(),i.error||e.setState({showToast:!0})):e.setState({isModalOpen:!0,authorizationFailure:403}):e.setState({isModalOpen:!0,authorizationFailure:401})})).catch((function(i){console.log("Error fetching disaster with id ",e.disasterId),console.log(i)}))}this.setState({isValidInformalName:i,isValidOfficialName:t,isValidDisasterType:a,isValidLatitude:n,isValidLongitude:s})}},{key:"resetDisasterForm",value:function(){this.setState({informalName:this.originalInformalName,officialName:this.originalOfficialName,disasterType:this.originalDisasterType,isOngoing:this.originalIsOngoing,latitude:this.originalLatitude,longitude:this.originalLongitude,isValidInformalName:!0,isValidOfficialName:!0,isValidDisasterType:!0,isValidLatitude:!0,isValidLongitude:!0})}},{key:"onModalClose",value:function(){this.setState({isModalOpen:!1,authorizationFailure:null})}},{key:"render",value:function(){var e=this,i=this.state,t=i.isValidInformalName,n=i.isValidOfficialName,s=i.isValidDisasterType,o=i.isValidLatitude,r=i.isValidLongitude,l=i.isModalOpen,c=i.authorizationFailure,j=i.informalName,g=i.showToast,m=i.disasterType,f=i.officialName,b=i.isOngoing,O=i.latitude,p=i.longitude;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(d.P,{children:Object(a.jsx)(d.j,{xs:"12",children:Object(a.jsxs)(d.f,{children:[Object(a.jsxs)(d.i,{children:[Object(a.jsx)("h4",{children:"Edit Disaster"}),Object(a.jsx)("div",{className:"top-information-text",children:Object(u.l)("edit disaster listings")})]}),Object(a.jsx)(d.g,{children:Object(a.jsxs)(d.t,{action:"",method:"post",encType:"multipart/form-data",className:"form-horizontal",children:[Object(a.jsxs)(d.u,{row:!0,children:[Object(a.jsx)(d.j,{md:"3",children:Object(a.jsx)(d.E,{htmlFor:"text-input",children:"Informal Name"})}),Object(a.jsxs)(d.j,{xs:"12",md:"9",children:[t&&Object(a.jsx)(d.C,{id:"text-input",name:"text-input",placeholder:"Text",value:j,onChange:this.onInformalNameChange.bind(this)}),!t&&Object(a.jsx)(d.C,{id:"text-input",invalid:!0,name:"text-input",placeholder:"Text",value:j,onChange:this.onInformalNameChange.bind(this)}),Object(a.jsx)(d.D,{children:"Informal name is blank or format is not recognized"}),Object(a.jsx)(d.v,{children:"The colloquial name of the disaster"})]})]}),Object(a.jsxs)(d.u,{row:!0,children:[Object(a.jsx)(d.j,{md:"3",children:Object(a.jsx)(d.E,{htmlFor:"official-name-input",children:"Official Name"})}),Object(a.jsxs)(d.j,{xs:"12",md:"9",children:[n&&Object(a.jsx)(d.C,{id:"official-name-input",name:"official-name-input",placeholder:"Text",value:f,onChange:this.onOfficialNameChange.bind(this)}),!n&&Object(a.jsx)(d.C,{id:"official-name-input",invalid:!0,name:"official-name-input",placeholder:"Text",value:f,onChange:this.onOfficialNameChange.bind(this)}),Object(a.jsx)(d.D,{children:"Official name is blank or format is not recognized"}),Object(a.jsx)(d.v,{children:"The identifying name of the disaster"})]})]}),Object(a.jsxs)(d.u,{row:!0,children:[Object(a.jsx)(d.j,{md:"3",children:Object(a.jsx)(d.E,{htmlFor:"select",children:"Disaster Type"})}),Object(a.jsxs)(d.j,{xs:"12",md:"9",children:[s&&Object(a.jsx)(d.Q,{custom:!0,name:"select",id:"select",value:m,onChange:this.onDisasterTypeChange.bind(this),children:u.b.map((function(e){return Object(a.jsx)("option",{value:e,children:e},e)}))}),!s&&Object(a.jsx)(d.Q,{invalid:!0,custom:!0,name:"select",id:"select",value:m,onChange:this.onDisasterTypeChange.bind(this),children:u.b.map((function(e){return Object(a.jsx)("option",{value:e,children:e},e)}))}),Object(a.jsx)(d.D,{children:"No disaster type is selected"})]})]}),Object(a.jsxs)(d.u,{row:!0,children:[Object(a.jsx)(d.j,{tag:"label",sm:"3",className:"col-form-label",children:"Disaster Ongoing"}),Object(a.jsx)(d.j,{sm:"1",children:Object(a.jsx)(d.Z,{id:"add-disaster-ongoing-switch",className:"mr-1",color:"danger",shape:"pill",checked:b,onChange:this.onIsOngoingChange.bind(this)})}),Object(a.jsx)(d.j,{sm:"3",children:Object(a.jsx)(d.E,{htmlFor:"add-disaster-ongoing-switch",children:b?"Yes":"No"})})]}),Object(a.jsxs)(d.u,{row:!0,children:[Object(a.jsx)(d.j,{md:"3",children:Object(a.jsx)(d.E,{htmlFor:"latitude-input",children:"Latitude"})}),Object(a.jsxs)(d.j,{xs:"12",md:"9",children:[o&&Object(a.jsx)(d.C,{id:"latitude-input",name:"latitude-input",placeholder:"Disaster Latitude",value:O,onChange:this.onLatitudeChange.bind(this)}),!o&&Object(a.jsx)(d.C,{invalid:!0,id:"latitude-input",name:"latitude-input",placeholder:"Disaster Latitude",value:O,onChange:this.onLatitudeChange.bind(this)}),Object(a.jsx)(d.D,{children:"Provided latitude is blank or format is not recognized"}),Object(a.jsx)(d.v,{className:"help-block",children:"The latitude of the disaster"})]})]}),Object(a.jsxs)(d.u,{row:!0,children:[Object(a.jsx)(d.j,{md:"3",children:Object(a.jsx)(d.E,{htmlFor:"longitude-input",children:"Longitude"})}),Object(a.jsxs)(d.j,{xs:"12",md:"9",children:[r&&Object(a.jsx)(d.C,{name:"longitude-input",placeholder:"Disaster Latitude",value:p,onChange:this.onLongitudeChange.bind(this)}),!r&&Object(a.jsx)(d.C,{invalid:!0,id:"longitude-input",name:"longitude-input",placeholder:"Disaster Latitude",value:p,onChange:this.onLongitudeChange.bind(this)}),Object(a.jsx)(d.D,{children:"Provided longitude is blank or format is not recognized"}),Object(a.jsx)(d.v,{className:"help-block",children:"The longitude of the disaster"})]})]})]})}),Object(a.jsxs)(d.h,{children:[Object(a.jsxs)(d.d,{type:"submit",size:"sm",color:"primary",onClick:this.onSubmit.bind(this),children:[Object(a.jsx)(h.a,{name:"cil-scrubber"})," Submit"]}),Object(a.jsxs)(d.d,{type:"reset",size:"sm",color:"danger",onClick:this.resetDisasterForm.bind(this),children:[Object(a.jsx)(h.a,{name:"cil-ban"})," Reset"]})]})]})})}),Object(a.jsxs)(d.I,{show:l,onClose:this.onModalClose.bind(this),children:[Object(a.jsx)(d.L,{closeButton:!0,children:Object(a.jsx)(d.M,{children:"Failure To Edit Disaster Listing"})}),Object(a.jsx)(d.J,{children:Object(u.j)("edit disaster listings",c)}),Object(a.jsx)(d.K,{children:Object(a.jsx)(d.d,{color:"secondary",onClick:function(){return e.onModalClose()},children:"OK"})})]}),Object(a.jsx)(d.eb,{position:"top-center",children:Object(a.jsxs)(d.bb,{show:g,autohide:5e3,fade:!0,children:[Object(a.jsx)(d.db,{closeButton:!0,children:"Disaster Listing Updated"}),Object(a.jsx)(d.cb,{children:"The disaster listing for ".concat(j," has been updated successfully!")})]},"toast")},"toaster-top-center")]})}}]),t}(c.a.Component);i.default=j}}]);
//# sourceMappingURL=7.ce066f44.chunk.js.map